import React, { useState, useEffect } from 'react';
import { FaWallet, FaSignOutAlt, FaRobot, FaMoon, FaSun, FaCog } from 'react-icons/fa';

const TradingDashboard = () => {
  const [botRunning, setBotRunning] = useState(false);
  const [darkMode, setDarkMode] = useState(false);
  const [profit, setProfit] = useState(0);
  const [availableFunds, setAvailableFunds] = useState(100000);
  const [totalPnL, setTotalPnL] = useState(0);
  const [notifications, setNotifications] = useState([]);
  const [currentTime, setCurrentTime] = useState(new Date().toLocaleTimeString());
  const [openPositions, setOpenPositions] = useState([]);
  const [openOrders, setOpenOrders] = useState([]);

  const [ws, setWs] = useState(null);

  useEffect(() => {
    const socket = new WebSocket('wss://your-angel-one-websocket-url');

    socket.onopen = () => {
      console.log('WebSocket connection established');
      socket.send(JSON.stringify({
        action: 'subscribe',
        channels: ['market-data', 'order-status', 'account-info'],
      }));
    };

    socket.onmessage = (event) => {
      const data = JSON.parse(event.data);

      if (data.type === 'market-data') {
        setOpenPositions(data.positions || []);
      }

      if (data.type === 'order-status') {
        setOpenOrders(data.orders || []);
      }

      if (data.type === 'account-info') {
        setAvailableFunds(data.balance);
        setTotalPnL(data.totalPnL);
      }
    };

    socket.onclose = () => {
      console.log('WebSocket connection closed');
    };

    setWs(socket);

    return () => {
      if (ws) {
        ws.close();
      }
    };
  }, []);

  const toggleBot = () => {
    const message = botRunning ? 'Bot Stopped' : 'Bot Started';
    setBotRunning(!botRunning);
    setNotifications(prev => [...prev, `${message} - ${new Date().toLocaleTimeString()}`]);
  };

  return (
    <div className={`${darkMode ? 'bg-black text-white' : 'bg-white text-black'} p-10 min-h-screen`}>Hello, World!</div>
  );
};

export default TradingDashboard;
